<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dadagum.team.mapper.ResourceMapper">
    <insert id="insertResource" useGeneratedKeys="true" keyProperty="resource.id" parameterType="com.dadagum.team.common.model.ProjectResource">
        insert into project_resource( name, quantity, pid, create_time, gid)
        values (#{resource.name},#{resource.quantity},#{resource.pid},#{resource.createTime},#{resource.gid})
    </insert>
    
    <delete id="deleteResourceById">
        delete from project_resource where id=#{rid}
    </delete>
    
    <select id="getResourceById" resultType="com.dadagum.team.common.model.ProjectResource">
        select * from project_resource where id=#{rid}
    </select>
    
    <select id="listResource" resultType="com.dadagum.team.common.model.ProjectResource">
        select * from project_resource where 1=1 
        <if test="query.pid!=null and query.pid!=''">
           and pid=#{query.pid}
        </if>
    </select>
    
    <update id="updateResource">
        update  project_resource
          <!--<set>-->
              <!--<if test="record.name!=null and record.name!=''">-->
                  <!--name=#{record.name}-->
              <!--</if>-->
              <!--<if test="record.num!=null and record.num!=''">-->
                  <!--quantity=quantity+#{record.num}-->
              <!--</if>-->
          <!--</set>-->
        set quantity=quantity+#{record.num}
        where id=#{rid}
    </update>

    <insert id="insertResourceRecord" useGeneratedKeys="true" keyProperty="record.id" parameterType="com.dadagum.team.common.model.ResourceRecord">
        insert into resource_record(rid, details, num, time)
        values (#{record.rid},#{record.details},#{record.num},#{record.time})
    </insert>

    <select id="listResourceRecord" resultType="com.dadagum.team.common.model.ResourceRecord">
        select * from resource_record where rid=#{rid}
    </select>

</mapper>
